"""Description des changements

Revision ID: c2b1f41345c4
Revises: dd690d933758
Create Date: 2024-03-26 18:01:54.383634

"""
from typing import Sequence, Union

from alembic import op
import sqlalchemy as sa


def column_exists(table_name, column_name):
    bind = op.get_context().bind
    insp = sa.inspect(bind)
    columns = insp.get_columns(table_name)
    return any(c["name"] == column_name for c in columns)

# revision identifiers, used by Alembic.
revision: str = 'c2b1f41345c4'
down_revision: Union[str, None] = 'dd690d933758'
branch_labels: Union[str, Sequence[str], None] = None
depends_on: Union[str, Sequence[str], None] = None


def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    if(not column_exists('users', 'mail')):
        op.add_column('users', sa.Column('mail', sa.String(), nullable=False))
    if(not column_exists('users', 'mail_manager')):
        op.add_column('users', sa.Column('mail_manager', sa.String(), nullable=True))
    if(column_exists('users', 'id_manager')):
        op.drop_column('users', 'id_manager')
    # ### end Alembic commands ###


def downgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.add_column('users', sa.Column('id_manager', sa.VARCHAR(), autoincrement=False, nullable=True))
    op.drop_column('users', 'mail_manager')
    op.drop_column('users', 'mail')
    # ### end Alembic commands ###
